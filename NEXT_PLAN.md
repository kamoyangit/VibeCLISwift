# NEXT PLAN: VibeCLISwift 新機能拡張の提案

VibeCLISwiftの現在の実装（単一ファイルのスクリプト生成、コンパイルエラーの自動修正ループ）を基盤として、さらに強力で実用的なツールにするための新機能の提案です。

## 1. SPM（Swift Package Manager）プロジェクトの自動構築と外部依存（ライブラリ）のサポート
*   **概要:** 現在の `swiftc` で単一の `.swift` ファイルをコンパイルする仕様から、SPM形式 (`swift package init --type executable`) での出力・ビルドをサポートします。
*   **有効性:** `swift-argument-parser`（引数解析）や、ネットワーク通信用の `Alamofire`、ファイル解析用の `Yams` (YAMLパース) などを利用した、本格的で複雑なCLIツールをAIに生成させることができるようになります。

## 2. 生成後の対話型リファインメント（追加・修正リクエスト）機能
*   **概要:** コンパイルが成功して実行ファイルができた直後に、ユーザーに対して「想定通りに動作しましたか？ 追加の修正や機能追加はありますか？(y/n)」と尋ねるプロンプトを出します。
*   **有効性:** 現在は「一発生成」ですが、実際は「動いたけど、出力フォーマットを少し変えたい」「オプションを追加したい」というケースが発生します。対話ループを維持することで、元の状態（コンテキスト）を保ったままコードを段階的に育てることができます。

## 3. テストコード（XCTest）の自動生成と検証ループ
*   **概要:** メインのCLIコードを生成するだけでなく、そのロジックを検証する `XCTest` のテストコードも同時に生成させます。
*   **有効性:** コンパイルが通ること（文法エラーがないこと）と、要件通りに動くこと（論理エラーがないこと）は異なります。テストコードも併せて生成し、`swift test` を裏で実行して落ちた場合はLLMに修正させる「論理的な自己修復ループ」が実現できます。

## 4. 設定（プロファイル）の永続化
*   **概要:** 一度入力した LM Studio のURLや DeepSeek のAPIキー、よく使うLLMのモデル名などを `~/.vibeclirc` などの設定ファイルに保存し、次回起動時に読み込めるようにします。
*   **有効性:** 毎回起動時に設定を選ぶ手間が省け、ツールとしてのUX（開発者体験）が向上します。

## 5. マルチファイル生成のサポート
*   **概要:** アプリの規模が大きくなってきた際に、すべてのロジックを1つのファイルに押し込まず、LLMに「クラス・構造体ごとに複数の `.swift` ファイルに分割して出力」するよう指示します。
*   **有効性:** 生成されたツールを後から人間がメンテナンスしたり、拡張したりする際の可読性が劇的に上がります。

---
**次のステップの候補**
現在の軽量なアーキテクチャを保ったまま追加しやすく、かつUXの向上を実感しやすい機能として、「**2. 生成後の対話型リファインメント**」または「**4. 設定の永続化**」からの着手が推奨されます。
